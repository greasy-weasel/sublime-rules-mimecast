attack_types:
- Credential Phishing
description: Detects messages containing links to Freshdesk support solution pages
  that redirect to external domains with credential theft language, excluding legitimate
  Freshworks domains and organizational domains.
detection_methods:
- Content analysis
- Natural Language Understanding
- URL analysis
- URL screenshot
id: edd6acf7-907f-5b06-aa2b-30ecc4982841
name: 'Link: Multistage landing - FreshDesk knowledge base abuse'
severity: high
source: |-
  type.inbound
  and length(body.links) < 10
  and any(filter(body.links,
                  strings.ends_with(.href_url.query_params,"freshdesk.com")
                 and strings.icontains(.href_url.path, 'support/solutions')
          ),
          // link to unknown domain on the page
          length(filter(ml.link_analysis(.).final_dom.links,
                         not(any(["freshworks.com"], strings.ends_with(..href_url.query_params,.)))
                        and  not(any($org_domains, strings.ends_with(..href_url.query_params,.)))
                        and  not(strings.ends_with(.href_url.query_params,sender.email.domain.root_domain))
                 )
          ) < 3
          // cred theft language on the page
          and any(ml.nlu_classifier(ml.link_analysis(.).final_dom.display_text).intents,
                  .name == "cred_theft" and .confidence != "low"
          )
  )
tactics_and_techniques:
- Open redirect
- 'Impersonation: Brand'
- Social engineering
tags:
- Mimecast Hard to Fix
type: rule
